{% extends "base.html" %}

{% block content %}
  <div class="container">
    <h1>Award Points</h1>
    <hr>

    {% if current_user.is_teacher() %}
      <div class="row">
        <div class="col-md-4">
          <div class="card mb-4">
            <div class="card-body">
              <h5 class="card-title">Weekly Point Limit</h5>
              <p class="card-text">You can award up to {{ current_user.weekly_point_limit }} points per week.</p>
            </div>
          </div>
        </div>
        
        <div class="col-md-8">
          <div class="card mb-4">
            <div class="card-body">
              <h5 class="card-title">Points Awarded This Week</h5>
              <div class="row">
                <div class="col-md-6">
                  <div class="progress">
                    <div class="progress-bar bg-success" role="progressbar" style="width: {{ current_user.points_awarded_percentage }}%;" aria-valuenow="{{ current_user.points_awarded_percentage }}" aria-valuemin="0" aria-valuemax="100">{{ current_user.points_awarded }}</div>
                  </div>
                  <p class="text-center mt-2">Points Awarded: {{ current_user.points_awarded }}</p>
                </div>
                <div class="col-md-6">
                  <div class="progress">
                    <div class="progress-bar bg-info" role="progressbar" style="width: {{ current_user.remaining_point_percentage }}%;" aria-valuenow="{{ current_user.remaining_point_percentage }}" aria-valuemin="0" aria-valuemax="100">{{ current_user.remaining_points }}</div>
                  </div>
                  <p class="text-center mt-2">Points Remaining: {{ current_user.remaining_points }}</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <form method="POST" action="{{ url_for('auth.award_points') }}">
        <div class="form-group">
          <label for="student_name">Student Name:</label>
          <input type="text" class="form-control" id="student_name" name="student_name" required>
        </div>
        <div class="form-group">
          <label for="class_name">Class Name:</label>
          <input type="text" class="form-control" id="class_name" name="class_name" required>
        </div>
        <div class="form-group">
          <label for="amount">Amount:</label>
          <input type="number" class="form-control" id="amount" name="amount" min="1" max="{{ current_user.remaining_points }}" required>
        </div>
        <button type="submit" class="btn btn-primary">Award Points</button>
      </form>

      {% if errors %}
        <div class="alert alert-danger mt-3" role="alert">
          {{ errors }}
        </div>
      {% endif %}

      {% if success %}
        <div class="alert alert-success mt-3" role="alert">
          {{ success }}
        </div>
      {% endif %}

    {% else %}
      <div class="alert alert-danger mt-3" role="alert">
        You must be a teacher to access this page.
      </div>
    {% endif %}

   
{% endblock %}
